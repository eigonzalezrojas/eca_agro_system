{% extends "/dashboard/client.html" %}

{% block title %}Inicio{% endblock %}

{% block content %}
    <div class="w-full px-4 py-6">
        <h1 class="mb-6 text-3xl font-bold text-center">Métricas de Cultivo</h1>

        <!-- Bloque estado actual -->
        <div class="bg-gray-100 shadow-lg rounded-xl p-8 mb-10" id="bloque-inicio">
            <h5 class="text-center text-2xl font-semibold mb-6">Estado Actual</h5>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-8 justify-center text-center">

                <!-- Bloque de temperatura -->
                <div class="flex flex-col items-center bg-white p-6 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-thermometer">
                        <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/>
                    </svg>
                    <p class="mt-3 mb-1 text-lg font-medium">Temperatura</p>
                    <p id="temperatura" class="text-2xl font-bold text-gray-700">--°C</p>
                </div>

                <!-- Bloque de humedad -->
                <div class="flex flex-col items-center bg-white p-6 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-droplets"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/>
                        <path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/>
                    </svg>
                    <p class="mt-3 mb-1 text-lg font-medium">Humedad</p>
                    <p id="humedad" class="text-2xl font-bold text-gray-700">--%</p>
                </div>

                <!-- Bloque de fecha y hora -->
                <div class="flex flex-col items-center bg-white p-6 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock-9">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 7.5 12"/>
                    </svg>
                    <p class="mt-3 mb-1 text-lg font-medium">Última Actualización</p>
                    <p id="fecha_hora" class="text-xl font-bold text-gray-700">--/--/---- --:--:--</p>
                </div>

                <!-- Bloque de horas frío -->
                <div class="flex flex-col items-center bg-white p-6 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-snowflake"><path d="m10 20-1.25-2.5L6 18"/><path d="M10 4 8.75 6.5 6 6"/><path d="m14 20 1.25-2.5L18 18"/><path d="m14 4 1.25 2.5L18 6"/><path d="m17 21-3-6h-4"/><path d="m17 3-3 6 1.5 3"/><path d="M2 12h6.5L10 9"/><path d="m20 10-1.5 2 1.5 2"/>
                        <path d="M22 12h-6.5L14 15"/><path d="m4 10 1.5 2L4 14"/>
                        <path d="m7 21 3-6-1.5-3"/><path d="m7 3 3 6h4"/>
                    </svg>
                    <p class="mt-3 mb-1 text-lg font-medium">Horas Frío</p>
                    <p id="horas_frio" class="text-2xl font-bold text-gray-700" title="Calculando...">--</p>
                    <small class="text-gray-500">últimas 24h</small>
                </div>

                <!-- Bloque de grados días -->
                <div class="flex flex-col items-center bg-white p-6 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/>
                        <path d="m6.34 17.66-1.41 1.41"/>
                        <path d="m19.07 4.93-1.41 1.41"/>
                    </svg>
                    <p class="mt-3 mb-1 text-lg font-medium">GDA</p>
                    <p id="gda" class="text-2xl font-bold text-gray-700">--</p>
                    <small class="text-gray-500">últimas 24h</small>
                </div>
            </div>
        </div>
    </div>


    <!-- Filtros -->
    <div class="row mb-4 align-items-end">
        <!-- Selector de dispositivo -->
        <div class="col-md-3 mb-3">
            <label for="chipidSelect" class="form-label">Dispositivo</label>
            <select id="chipidSelect" class="form-select">
                <option value="">Todos los dispositivos</option>
                {% for chipid in chipids %}
                <option value="{{ chipid }}">Dispositivo {{ chipid }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Selector de período -->
        <div class="col-md-3 mb-3">
            <label for="periodSelect" class="form-label">Período</label>
            <select id="periodSelect" class="form-select">
                <option value="day">Último día</option>
                <option value="week">Última semana</option>
                <option value="month">Por mes</option>
                <option value="custom">Por fecha</option>
            </select>
        </div>

        <!-- Contenedor para selección por mes (año y mes) -->
        <div class="col-md-6 mb-3" id="monthYearContainer" style="display: none;">
            <div class="row">
                <!-- Selector de año -->
                <div class="col-md-6">
                    <label for="yearSelect" class="form-label">Año</label>
                    <select id="yearSelect" class="form-select"></select>
                </div>
                <!-- Selector de mes -->
                <div class="col-md-6">
                    <label for="monthSelect" class="form-label">Mes</label>
                    <select id="monthSelect" class="form-select">
                        <option value="01">Enero</option>
                        <option value="02">Febrero</option>
                        <option value="03">Marzo</option>
                        <option value="04">Abril</option>
                        <option value="05">Mayo</option>
                        <option value="06">Junio</option>
                        <option value="07">Julio</option>
                        <option value="08">Agosto</option>
                        <option value="09">Septiembre</option>
                        <option value="10">Octubre</option>
                        <option value="11">Noviembre</option>
                        <option value="12">Diciembre</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Contenedor para fecha específica -->
        <div class="col-md-3 mb-3" id="customDateContainer" style="display: none;">
            <label for="customDate" class="form-label">Fecha específica</label>
            <input type="date" id="customDate" class="form-control">
        </div>
    </div>

    <!-- Gráficos -->
    <div id="chartContainer">
        <div class="row">
            <div class="col-md-6 mb-4">
                <canvas id="tempChart"></canvas>
            </div>
            <div class="col-md-6">
                <canvas id="humChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Tabla de Temperatura -->
    <div id="temperatureTableContainer" class="table-container">
        <table id="temperatureTable" class="table table-striped">
            <thead>
                <tr>
                    <th>Dispositivo</th>
                    <th>Temperatura Máxima (°C)</th>
                    <th>Temperatura Mínima (°C)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las filas se generarán dinámicamente -->
            </tbody>
        </table>
    </div>

    <!-- Tabla de Humedad -->
    <div id="humidityTableContainer" class="table-container">
        <table id="humidityTable" class="table table-striped">
            <thead>
                <tr>
                    <th>Dispositivo</th>
                    <th>Humedad Máxima (%)</th>
                    <th>Humedad Mínima (%)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las filas se generarán dinámicamente -->
            </tbody>
        </table>
    </div>
{% endblock %}